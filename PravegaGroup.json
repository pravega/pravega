{
  "id": "/pravega",
  "groups": [
    {
      "id": "/pravega/bkgroup",
      "apps": [
      { 
          "id": "/pravega/bkgroup/bookie", 
          "cpus": 1,
          "mem": 1024,
          "instances": 3,
          "constraints": [["hostname", "UNIQUE"]],
          "container": {
              "type": "DOCKER",
              "volumes": [
              {
                  "containerPath": "/bk/journal",
                  "hostPath": "/mnt/journal",
                  "mode": "RW"
              },
              {
                  "containerPath": "/bk/index",
                  "hostPath": "/mnt/index",
                  "mode": "RW"
              },
              {
                  "containerPath": "/bk/ledgers",
                  "hostPath": "/mnt/ledgers",
                  "mode": "RW"
              },

              {
                  "containerPath": "persist",
                  "mode": "RW",
                  "persistent": {
                      "size": 70
                  }
              }
              ],

              "docker": {
                  "image": "zhaijia/bookie",
                  "network": "HOST"
              }
          },

          "portDefinitions": [
          {
              "protocol": "tcp",
              "port": 3181
          },
          {
              "protocol": "tcp",
              "port": 12345
          },
          {
              "protocol": "tcp",
              "port": 9090 
          }

          ],

          "requirePorts": true,

          "env": {
              "ZK": "master.mesos:2181"
          },

          "healthChecks": [
          {
              "protocol": "TCP",
              "port": 3181,
              "gracePeriodSeconds": 900,
              "intervalSeconds": 60,
              "timeoutSeconds": 20,
              "maxConsecutiveFailures": 0,
              "ignoreHttp1xx": false
          }
          ],

          "upgradeStrategy": {
              "maximumOverCapacity": 0,
              "minimumHealthCapacity": 0
          }

      }
      ]
    },
    {
      "id": "/pravega/hostgroup",
      "dependencies": ["/pravega/bkgroup","/pravega/controllergroup"],
      "apps": [
      { 
          "id": "/pravega/hostgroup/host", 
          "cpus": 2,
          "mem": 1000,
          "instances": 2,
          "constraints": [["hostname", "UNIQUE"]],
          "container": {
              "type": "DOCKER",
             "volumes": [
              {
                  "containerPath": "/tmp/logs",
                  "hostPath": "/mnt/logs",
                  "mode": "RW"
              }
                ],

              "docker": {
                  "image": "zhaijia/pravega_host",
                  "network": "HOST"
              }
          },

          "portDefinitions": [
          {
              "protocol": "tcp",
              "port": 12345
          }
          ],

          "requirePorts": true,

          "healthChecks": [
          {
              "protocol": "TCP",
              "port": 12345,
              "gracePeriodSeconds": 900,
              "intervalSeconds": 60,
              "timeoutSeconds": 20,
              "maxConsecutiveFailures": 0,
              "ignoreHttp1xx": false
          }
          ],

          "upgradeStrategy": {
              "maximumOverCapacity": 0,
              "minimumHealthCapacity": 0
          }
      }
      ]
    },
    {
      "id": "/pravega/controllergroup",
      "apps": [
      { 
          "id": "/pravega/controllergroup/controller", 
          "cpus": 0.4,
          "mem": 1000,
          "instances": 2,
          "constraints": [["hostname", "UNIQUE"]],
          "container": {
              "type": "DOCKER",
              "docker": {
                  "image": "zhaijia/pravega_controller",
                  "network": "HOST"
              }
          },

          "portDefinitions": [
          {
              "protocol": "tcp",
              "port": 9090 
          }
          ],

          "requirePorts": true,
          "env": {
              "SERVER_OPTS": "-DZK_URL=master.mesos:2181"
          },
          "healthChecks": [
          {
              "protocol": "TCP",
              "port": 9090,
              "gracePeriodSeconds": 900,
              "intervalSeconds": 60,
              "timeoutSeconds": 20,
              "maxConsecutiveFailures": 0,
              "ignoreHttp1xx": false
          }
          ],

          "upgradeStrategy": {
              "maximumOverCapacity": 0,
              "minimumHealthCapacity": 0
          }
      }
      ]
    }
  ]
}

