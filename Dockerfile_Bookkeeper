#
#  Copyright (c) 2017 Dell Inc., or its subsidiaries.
#

FROM java:8
MAINTAINER Jia Zhai <jia.zhai@emc.com>

RUN apt-get update \
&&  apt-get install -y wget unzip \
&&  mkdir -p /opt \
&&  cd /opt

RUN wget https://github.com/twitter/distributedlog/releases/download/0.3.51-RC1/distributedlog-service-3ff9e33fa577f50eebb8ee971ddb265c971c3717.zip \
&& unzip distributedlog-service-3ff9e33fa577f50eebb8ee971ddb265c971c3717.zip \
&& mkdir -p /opt/dl_all \
&& mv distributedlog-service /opt/dl_all/

ENV bookiePort 3181

EXPOSE $bookiePort

# all execute-able bin, download from distributed_log
WORKDIR /opt/dl_all

# After container up, Following instructions to build bookie cluster
# http://distributedlog.incubator.apache.org/docs/latest/deployment/cluster.html
COPY /entry_point.sh /opt/dl_all/entry_point.sh
ENTRYPOINT /opt/dl_all/entry_point.sh

